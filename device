/***************************************************
  This is our GFX example for the Adafruit ILI9341 Breakout and Shield
  ----> http://www.adafruit.com/products/1651

  Check out the links above for our tutorials and wiring diagrams
  These displays use SPI to communicate, 4 or 5 pins are required to
  interface (RST is optional)
  Adafruit invests time and resources providing this open source code,
  please support Adafruit and open-source hardware by purchasing
  products from Adafruit!

  Written by Limor Fried/Ladyada for Adafruit Industries.
  MIT license, all text above must be included in any redistribution
 ****************************************************/

#include "SPI.h"
#include "Adafruit_GFX.h"
#include <U8g2_for_Adafruit_GFX.h>
#include "Adafruit_ILI9341.h"
#include <nRF24L01.h>
#include <MFRC522.h>

#define SS_PIN 5
#define RST_PIN 4
 
MFRC522 rfid(SS_PIN, RST_PIN); // Instance of the class

MFRC522::MIFARE_Key key; 

// Init array that will store new NUID 
byte nuidPICC[4];


#include <RF24.h>
RF24 radio(7, 6); // SPI 버스에 nRF24L01 라디오를 설정하기 위해 CE, CSN를 선언.
const byte address[6] = "00001"; //주소값을 5가지 문자열로 변경할 수 있으며, 송신기와 수신기가 동일한 주소로 해야됨.

 
// For the Adafruit shield, these are the default.
#define TFT_RST 8   // You have to add this   
#define TFT_DC 9
#define TFT_CS 10


U8G2_FOR_ADAFRUIT_GFX u8g2_for_adafruit_gfx;
// Use hardware SPI (on Uno, #13, #12, #11) and the above for CS/DC
Adafruit_ILI9341 tft = Adafruit_ILI9341(TFT_CS, TFT_DC, TFT_RST);
// If using the breakout, change pins as desired
//Adafruit_ILI9341 tft = Adafruit_ILI9341(TFT_CS, TFT_DC, TFT_MOSI, TFT_CLK, TFT_RST, TFT_MISO);

/*
  Fontname: -FontForge-Jalnan 2 TTF-Book-R-Normal--48-460-75-75-P-477-ISO10646-1
  Copyright: Copyright (c) GC COMPANY All rights reserved. Font Designed by Sandoll Inc.
  Glyphs: 69/12363
  BBX Build Mode: 0
*/
const uint8_t JalnanTTF[8558] U8G2_FONT_SECTION("JalnanTTF") = 
  "E\0\6\6\6\6\3\5\7\61\63\0\367(\363+\373\0\0\0\0\0\213!\33\312\372\6\25\14\3\42"
  "H\4\77\340\37\300\271\10\4\42H\4\262\0A\20\6\0,\33\12\344\343\34\10\304AH\4\262 A"
  "\30\210BQ \12\303A\70\14\205\2\0.\20\212\342\346\34\10\4\42\340\5\10\202\60\0\0\77C\334"
  "\332\346M\26\16d\231\34\226\2Cd\4\255\240\61\134\214\12BA\24\1\42Q\4\7EA\10\30E"
  "\264\200\26O\303i\64\17\346\301\70\234\246g\21)$\345\375\0\207`!\250\204\244\274\11a\25\30\0"
  "\0\0\0\4\377\377\254\0\224ok\366\27\15K\204A \26$q`\16\205\221\61\24F\306P\30\31"
  "Cah\12\305\221)\24\212\245PX\212Ba)\12\205\245(\24\226\242PX\212Ba)\12\205\245"
  "(\30\224\242pH\212\342\21)\212G\244(\36\221\242xD\11\343\21%\14\207\224\60\32\222\302PT"
  "\12CQ)\14\5\245\70\24\224\342PL\213C!-\20\5\324@\24\216#Q(\21EqL\26\205"
  "AY\24\5\205Q\24\22GQD\36\205\341\210\24\306\202R \3MQ*\25\0\254tpk{\366"
  "\27\15\306dA\14\227$!`\220\204\200A\22B\346H\10\231#!d\216\4q\71\22\221\342HD"
  "\212#\21i\203\266\234N\343ID\202EI\4\226%\21T\230D@i\22\301\304I\4\21(!\64"
  "\246\4Q\310\22b\302 `\211\342`%\210D\225\30\24UbPT\211AQ%\6E\250\24\236\210"
  "\224\220\66\240\21\247#\64\0\0\254\203{l{\366\27\15FEA\20\227$\61`\220\304\220\71\22C"
  "\346H\14\231#A`\216\204a\71\22\222\342HH\212#!i\213\266\236\216\343Q Ib\260(\11"
  "\301\262$\204\12\223\20(MB\230\70\11!\2%\206\306\224(\12\215@IT\207#A!\216\304\244"
  "\20\25\341\243\223d\25\13#m\234\317a**\304c\250 \214\201\242\60\4I\263\20 \220bhH"
  "\213\1q)\0\254\340X\354\352\366\37F\210\251@\21\251!\215@\25'Q\61&\77\251\260( \204"
  "\242\200\22\211\2J$\212G\221(\36E\222\200\24I\2R \12H\201( \5\242\200\24H\42R"
  "\34\212Hq(\42\5\202\220\24\211aR\60\201J!*Y\252\340\7\374\3\30\2J\0\0\255l-"
  ",k\366\37H\307\211@\21\251!\215@\25'Q\61&OTNL\214\11Q)T\24\252\340\7\374"
  "\3\30\2jR\210\312\377E\0\256L\313p[\366'\15\312\5A\30\35\42ax\6\5\361\31\24\304"
  "gP\24\236AQx\6\205\321\31\24L\242H\14\12&Q$\6\5\223(\22\203\202I\24\211A\301"
  "$\212\304\240`\22EbP\60\211\42\61(\230D\221\30\26K\242H\14\215$Q$\6\7\222(\22"
  "\203\3I\24\211\301\201$\212\304\340@\22Ebp \211\42\61\70\220D\221\30\30J\242H\14\12&"
  "Q$\6\5\203\60\22\203\202A\30\211A\261$\214\304\240X\22FbP(\12#\61(\22\205\221 "
  "\24\7\303H\20\212\242a(\10E\321 \26\205\202h\14\215BA\60\206\206\241(\24\203\303P\24\210"
  "\242q(\14\2\302@\24SBQL\210EQ\15\34\205\251 \0\260\230\201n{\366\17\15'\2\61"
  "\134\211\3a)\212\204\245(\24\225\242PT\212BQ)\12E\245(\24\225\242PT\212BQ)\12"
  "E\245(\24\225\242PT\212BQ)\12E\305\30\24\225#PT\331\253\34\201\242j\10\212JQ("
  "*E\241\250\24\205\242R\24\212JQ(*E\241\250\24\205\242R\24\212JQl\10E\301\31\24\5"
  "gP\24\234AQp\6\205\261\31\24\306fP \30BA*+\0\260\240an{\366\17\15\211\1"
  "C\34\210+Q$,E\221\260\24E\302R\24\11KQ$\254\206\220\260\34A\302\302fe*\25\341"
  "\10\70CC\340\14\212\202\63(\12\316\240\60\66\203\342\320\14\12\245R(H\205MJL\310\351\70C"
  "L\244RRBL\307\231\201\62\26\343\202D\31h\307\11\61)\243\2\0\261\10\64j{\366\27\15#"
  "b\60d\211\0\201I\260\311\65\375\307x\226\217\2\226\204)`\313\347\232\376]$\243T\224+\22\301"
  "\246H\4\233\42\61`\214D\230\14\261\200Dlk\366'\12\346\201L\214\311\215\245\3E\240\210\324\220"
  "\42N\206iR\210J\321\17\370\3>\201\352\7t%\3\65\244\21(\343$*\216\22\201\32R\202\232"
  "\260\10\25\242JX\5+A\65\240\16\222\0\0\262\4,,k\366'\14%bL\214\12Q\371'\232"
  "\214S\201\42\320\212\63\243\364\3\331\252\340\7\374\1\237@E\230(\205\250\374\27\1\0\262\230Alk"
  "\366'\12\346\201L\214\311\215\245\3E\240\210\324\220\42N\206\351\7t(\341\7\374\1\237@\365\3%"
  "'\42\65\244\10\24\221\22\225\10\324\220\22\324\11\12Q%\254\202\225\240\32P\7I\0\0\262\310*j"
  "{\366\27\15#b\60d\211\0\201I\260\311\65\375\377\377\337U*L\204\71\42\21p\210\204\260!\22"
  "C\246H\204\311\0\262\344\206n{\366\17\15\13\5A \27#qd\12E\241)\24\205\246P\24\232"
  "BQh\12E\221\61\24\305\202R\24\212JQ(*E\241\250\24\205\242R\24\212JQ(*E\241"
  "\250\30\203\242r\4\212*{\225#PT\15AQ)\12E\245(\24\225\242PT\212BQ)\12E"
  "\245(\24\225\242PT\212BQ)\12E\245(\66\204\242\340\14\212\202\63(\12\316\240(\70\203\302\330"
  "\14\212C\63(\22K\241 \225\12\0\262\346\205\256\373\365\17\15\311\345@\34\31#Qh\12E\241)"
  "\24\205\246P\24\232BQd\14EqA\32B\302r\4\11\13{\226#HX\214aC(\12\316\240"
  "(\70\203\242\340\14\212\202\63(\214\315\240\70\62\204\202T\374\0\223\221\64\24\311\20\71&\302\304\240\4"
  "\23\203\22P\12J@\61&\302\304Y(\213G\261(\36\305\242x\24\213\342Q,\12G\301(\232\5"
  "\243h\26\214\242Qj\22\216\242A<\12\307\340\1\0\265\24\63j{\366\27\15\6%A\14\230#\21"
  "d\216\321A\62F\307\350\20!\24krM\377\377\177W\251\60\21\346\210D\300!\22\302\206H\20\27"
  "#\21&\1\267\221sn{\366\17\15\210%A\30\231#Qd\14E\241)\24\205\246P\30\231BA"
  "-\12E\245(\32\222\242p\24\226\342!`\212G\220)\322\25\216@Q\61\206\204\245(\24\225\242\350"
  "\10\212\242#(\12O\240\60:\201\342\330\10\12D#(HE\177\231>\315H)%\246\343\354PL"
  "\213BQ)\12E\245\60\24\323\302\70\35gHI\31\61!h\263\0\0\267\354]j{\366\27\15\305"
  "\343A\10\24\346\263\200\24\60%\21X\224D`Q\22\215BI\70\11%\341$\224\204\223P\22NB"
  "I\70\11%\341$\224\204\223P\22N\202x\14\24!\22X\204H`\21\320\33N\212\4\223~\330\344"
  "*\25&\342\64\234\15\211\240\63$\204\15\221\60*F\42L\2\270$aj{\366\27\15\305\343A\10"
  "\24\346\263|\26\220\2R\22\201EI\4\26%\321(\12G\243\30 \215B\210\64\12!\322(\204H"
  "\243\20\42\215B\210\64\212\1\322(\224\304@Q\22\201EI\4\26\5\234A\32N\202\6\322.\312`"
  "R\330\344*\25&\302\34\221\10\70DB\320\24\11\203r$\302$\271\310\266n{\366\17\15\213DA"
  " \226#q`\14E\241)\24\205\246P\24\232BQh\12E\241)\24E\2I\24\212\42\201$\12"
  "E\221@\22\205\242H \211BQ$\220D\241(\22H\242P\24\11$Q(\212\4\222(\30C\2"
  "I\24\216 \201$\12\14\222(\60H\242\300 \211\2\203$\12\14\222(\34A\2I\24\15!\201$"
  "\12E\221@\22\205\242H \211BQ$\220D\241(\22H\242P\24\11$Q(\212\4\222(\24E"
  "\2I\24\212\42\201$\12E\221@\22\205\242\320\24\212BS(\12M\241(\64\205\242\320\24\12#S"
  "(\16L\241H,\205\202T*\0\271\320qn{\366\17\15\211\5A\34\31#Qh\12E\241)\24"
  "\205\246P\24\232BQh\212\206\220H\20\205#H$\210\2\223 \12L\202(\60\11\242\300$\210\2"
  "\223 \12G\240)\32\202\246P\24\232BQh\12E\241)\24F\246P \227BA*\354\221bB"
  "N\307\31b\42\225\24\22b:\316\14\224\261\30\27\344\351@\31\250\343\204\230\26Q\1\0\272\70]j"
  "{\366\27\15\206dA\14\226$\21`\220\321\61\336!A\22\207\4I\34\22$qH\220\304!A\22"
  "\207\4I\34\22$qH\220\304!A\304\177H\342\220 \211C\202$\16\11\222\70$H\342\220 \211"
  "C\202$\16\11\222\70$H\342\30\337\221\10\62GB\300\34\11\302r$\302$\272\71\70j{\366\27"
  "\15DEA\10\30D\204\214\216q\207\4I\34\22D\374!\263c\274#\21d\216\204\200\71\22a\342"
  "\7h\240\343\64\234\204T\220\22\320\206\23\250\10\223\177\272K\206l{\366\27\15FEA\20\30$!"
  "d\220\204\240\71\22\202\346H\10\232#!h\216\204\220@\22GBH \31!\201d\204\4\222\21\22"
  "HFH \31!\201d\204\4\222\21\22HF\320\34\11As$\4\315\221\20\64GB\320\34\211!"
  "s$\10\314\221\30\223.\201\222\250\16G\202B\34\211I!*\302G'\311*\26F\332\70\237\303T"
  "T\210\307PA\30\3Ea\10\222f!@ \305\320\220\26\3\342R\0\273\64:,k\366'H\207"
  "\251@\21\350\21\12JA$\254\4\221\260\22D\302J\20\11+A$\254\4\221\260\22\4\372\212\63\204"
  "\364\3%\252\340\7\374\3\30\2jR\210\312\177\21\0\273P\214kk\366\37\15\206\5A\14\32#\21"
  "p\212D\300)\22\1\247H\4\35\42\21t\210D\220P\24D\42H(\12\42\21$\24\5\221\10\22"
  "\212\202H\4\35\42\21t\210D\320!\22A\207H\4\35\42!p\210\304\260!\22b\262\240C\240\206"
  "\224\220&\240\206D\340\31\22\203\246H$\212'\221(\236D\242 (\211b\250$\212\241\222(\4\13"
  "\262\20,\6\203\250\20\16\242\62\70\20\311\340\210\22CCJ\14\214)\61(\252Da\270\22\274%x"
  "n{\366'\2\220@\61 \207\305p \14\204\202\60\22E\42A\24\212\42\221$\10E\261!\24\305"
  "\206P\24\33BQl\10G\260!\324\10L\222 \60I\202\300$\11\2\223$\10G\220H\22\204\242"
  "\330\20\212bC(\212\15\241(\66\204\302\320\20\212#C(H\305\17(\17\327\1IT\211#Q%"
  "\216\363;\22U\342HT\211#Q%\216\363\20SRZF\5\0\274\60\304lk\366\327\14E\241 "
  "$\204\342@\34\204\203q \20\3\42\70\30\7\2!$\2D\201\30\20\202\204H\14\10AB$\6"
  "\204 !\22\3B\220\20\211\1!H\210\304\200\20$Db@\10\22\42\61 \4\11\221\30\20\302g"
  "@\10\237\1!|\6\204\360\31\20\302gH\67p\210\304\300!\22\3\207H\14\34\42\61p\210\304\200"
  "\20$Db@\10\22\42\61 \4\11\221\30\20\202\204H\14\10AB$\6\204 !\22\3B\220\20"
  "\211\1!H\210\304\200\20$Db@\10\237\1!|\6\204\220\10*\3BH\4\225\1!$\202\312"
  "\200\20\22Ae@\10\11\201\62 \204D\21\31\20B\42C\10\211\14!$\0\274\364H,\353\366\67"
  "\2^ \71`\207\42a!\12\5\245 \24\224\202PP\12BA)\10\364G((\5\241\240\24\204"
  "\202R\20\12JA((\5\241\240\24\4\372\212\223aRD\223BT~\222*\370\1\377\0\206\200\22"
  "\0\275\20\255ok\366/\2Q@\61$\7\306` \16\304\202 \22GBA\20\12#\221$\10\205"
  "\221H\22\204\302H$\11Bal\10\205\261!\24\306\206P\30\33Bal\10\205\261!\24\306\206P"
  "\30\211$A(\214D\222 \24F\42I\20\14\42\221$\10\207\220H\22\304#H$\11\342\21$\222"
  "\4\361\10\66\304#\330\20\217`C\70\204\15\321 \64\204\342\320\20\212\4C(\236D\243x\22\215\342"
  "I\64\212'\321(\236D\243x\22\215\342I\64\212CC(\212\316\240(<\202\242\360\10\212\302#("
  "\12\217\240(<\202\302\340\14\212R\251\0\0\276`\342ok\366\37\15H\301 \34\4\3a\34\210\3"
  "a \22\6b\70\14\210AA$\4\304\200\30\24DB@\14\210AA$\4\304\200\30\24DB@"
  "\14\210AA$\4\304\200\30\24DB@\14\210AA$\4\304\200\30\24DB@\14\210AA$\4"
  "\304\200\30\24\204gP\20\236AAx\6\5\341\31\26\203gh\4\236\201\65\134\4\304\200\30.\2b"
  "@\14\27\1\61 \206\213\200\30\20\303E@\14\210\201!$\4\304\200\30\24DB@\14\210AA$"
  "\4\304\200\30\24DB@\14\210AA$\4\304\200\30\24DB@\14\210AA$\4\304\200\30\24D"
  "B@\14\210AA$\4\304\200\30\24DB@\14\210AAx\6\5\341\31\24\204gP\24\235AQ"
  "t\6E\321\31\24\6gP(\230AQ*\21\0\276\320\242lk\366'\15D\301 \34\204\3!\34"
  "\210\3a\60\22\1b\70\14\10b\42 \6\4\61\21\20\3\202\230\10\210\1AL\4\304\200 &\2"
  "b@\20\23\1\61 \210\211\200\30\20\304D@\14\10b\42 \6\4\201\36\361\3~@F@\14\37"
  "\1\61|\4\304\360\21\20\303G@\14\37\1\61 \210\211\200\30\20\304D@\14\10b\42 \6\4\61"
  "\21\20\3\202\230\10\210\1AL\4\304\200 &\2b@\20\23\1\61 \210\211\200\30\20\4:B\21"
  "t\10E\320!\24A\207P\10\34Ba`\10\205\250\4\300\254\250qK\366'\15T!BH\207'"
  "\21%\34\5\224p\24P\302Q@\11G\1%\34\5\224p\24P\302Q@\11G\1%\34\5\224p"
  "\24P\302Q@\11G\1%\34\5\224p\30N\302q,\14\346\241\70\224\247\344\241@\220\207\22\71\36"
  "\212\304p(\23\243\261P\12\205C)\24\215\42X\20\212F!(\10\5\243 \22\204bY\20\212A"
  "\261(\12\305\240P\26FbP$\213#\61(\216\306\221\30\24F\3I\14\212\242\221$\6E\301P"
  "\22\203\242X,\211AQ(\230\304\240\60\20MbP\34\205'\61(Ne\5\0\302\366\203n[\366"
  "o\12\222\1:@\10'\361$\232\304\223h\22O\242I<\11F\361$\30\305\223`\24O\202q,"
  "\11\6\222$\26\11\222X&GB\251\30\11\344b$\216L\221 \36\302\242H\14\17bA$\206G"
  "\241 \22\302\303P\20\11\241\221$\210\304\260P\22DbH\60\11\42A\30\266D}\62REzG"
  "\211G,\10)\241$$E\242\210\24\211\42R$\212%E\250\210\325\260F\244\216\322\0\0\305(\313"
  "nK\366\67\15\12\321\202@\16\207AI\30H\210\302H\24\10Da$\12\4\242\60\22\5\2Q\30"
  "\211\2\201(\214D\201@\24F\242@ \12#Q \20\205\221(\20\210\302H\24\10Da$\12\4"
  "\242\60\22\5\2Q\30\211\2\201(\214D\201@\24\6\22\242\60\220\20\205\201\204(\14$Da !"
  "\12#A(\16\205\241\30\26\206\242`\10\214BQ\64\2F\241(\32A\203P\24\33BQp\6\5"
  "\321\31\24DgP\20\36A\61$\202\212\240\30\22\302\42@\10\12!\61,\2\204\240\10\24\303\42@"
  "\10\225A\61\34\4\12\241\30\20\301\204P\20\210@R$\12D\240\10\14F\242@\4\12a\200 \14"
  "D\240x\10\221\202T\2\305D\273n{\366g\10\221\301a\64\210\5\242$\24I\242@(\210\342\260"
  "\34\12\3c(\14\214\241(\30\303\242P\62\24\205\242H \211BQ$\220D\241(\22H\242P\24"
  "\11$Q(\212\4\222(\24E\2I\24\212\42\201$\12\306\220@\22\205#H \211\2\203$\12\14"
  "\222(\60H\242\300 \211\2\203$\12G\220@\22ECH \211BQ$\220D\241(\22H\242P"
  "\24\11$Q(\212\4\222(\24E\2I\24\212\42\201$\12E\221@\22\205\242H \211B\311P\24"
  "\212bA,\12\205\201\61\24\6\306P\34\226C\201T\16E\62A\24\12DQ\60\215E\1\21 \5"
  "\251(\0\305|\265n{\366g\10\221\301a\64\210\5\242$\24I\242@(\210\342\260\34\12\3c("
  "\14\214\241(\30\303\242P\62\24\205\242H \211\302\21$\220D\201A\22\5\6I\24\30$Q`\220"
  "D\201A\22\205#H \211\242!$\220D\241(\22H\242P\24\11$Q(\212\4\222(\24E\2"
  "I\24\212\42\201$\12E\221@\22\205\242H \211\202\61$\220D\341\10\22H\242\300 \211\2\203$"
  "\12\14\222(\60H\242\300 \211\302\21$\220D\321\20\24\206\242P\24\13bQ(\14\214\241\60\60\206"
  "\342\260\34\12\244r(\222\11\242P \212\202i,\12\210\0)HE\1\0\305\264}j{\366g\10"
  "\222!a\70\10\3\302$\10\311\222\30(JB\260$\211\0\203$\2\14R\31\26\307\304P\34\22$"
  "qH\220\304!A\22\207\4I\34\22$qH\220\304!A\22\207\4\21\377!\211C\202$\16\11\222"
  "\70$H\342\220 \211C\202$\16\11\222\70$H\342\230\30\212\203B,\216D\200A\22\1\6I\10"
  "\226$\61T\222\4\61Q\22\5\204I\34\215&\261\20\244D\230\0\305\304aj{\366O\20\221\1q"
  "\64\210B\262$\206J\222\20,I\42\300 \211 sP\210\305\61\61\24\207\4\21\37\62\62J\304\342"
  "\30\35\211\0\203$\204\13\222\20,I\202\220,\211\2\302$\20\305\223\370\1\232\310\60\15\247\1%\240"
  "\23\22VBHX\11!a%\204\204\225\20\22VB@o\70\63H\305\310\233\254\373\365O\20\221A"
  "q\64\210C\262$\212J\222 ,Ib\300 \211!s$\204\5\261\70\22\202\302P\34\11!\201d"
  "\204\4\222\21\22HFH \31!\201d\204\4\222\21\24\206FX\20\213#!h\216\304\200A\22\304"
  "\5I\20\226$aH\226\304\1a\22\212\342I\374\0\263\320\24&\204\202\220\22I\42J$\211(\221"
  "$\242D\222\200\32\5\303y\14\16\6\42<\224\21B:LCJp\10\220\0C\70\6K\321 *"
  "\6\303@\4\212cq \204\203\202H\20\325\200\2\0\306\10\260k{\366\317\14E\341P$\210\341@"
  "\64\20\304\200\20 \6BH\10\20\3!$\2I\201\20\22\201\244@\10\35\2!H\204\4\201\20\42"
  "\4\222\20!(B\204\240\10\21\202\42D\10\212\20!(B\204\240\10\21\202\42D\10\212\20!\220\204"
  "\10\201$D\10$!B \11\21\2I\210\20HB\204@\22\42\4\222\20!(B\204\240\10\21\202"
  "\42D\10\212\20!(B\204\240\10\21\202\42D\10\212\20!\220\204\10\201$t\10\204\320!\20B\42"
  "\220\24\10!\21H\12\204\220\20 \6BH\14\216\3!$\10\6\202\20\22\306aA\10\11\14!$"
  "\0\306$N\354\352\366O\64\220\247\1)$\204t\230\12\24\201\32\30\22CXP\13Aa)\4\205"
  "\245\20\24\226BPX\12Aa)\4\205\245\20\26\324bXH\13\2\255\60\35\244D\264\200\232\216\204"
  "\331\24\242\362'\251\202\37\360\17`\10(\1\0\306@\253ok\366o\6\222\341i\60\10&\222$\224"
  "\312\241@.\206\2\301\24\212#S(\16\15\241\60\26\305\202P\30\212CA(\214D\222 \24F\42"
  "I\20\12#\221$\10\205\221H\22\204\302H$\11Ba$\222\4\241\60\22I\202`\20\211$A\70"
  "\204D\222 \36\201\342P\20\217\200A,\210\207\240!\36B\246x\14\27\303QT\216\306\61A\24K"
  "$Q\70\214E\361$\32\305\223h\24O\242Q<\211F\361$\32\305\223h\24O\242Q\34\32BQ"
  "t\6E\341\21\24\205GP\24\36AQx\4E\341\21\24\6gP\224J\5\0\306D\211ok\366"
  "\27\15\314$A(\226#\201`\214\304\241)\22\306\246H\30\34\42a(\20\5\221\60\22J\202H\30"
  "\11%A$\214\204\222 \22F\42Q\20\11\203C\64\204M\341\20\64\205C\310\30\216\341r\70\12\12"
  "\342@\30McI\70\14&\341$\236\204\223\60:C\242\370\10\211\342#$\212\217\220(>B\242\360"
  "\14\11\203C$\314\4#\300\22\312\241J$\210*\201(\250\4\242(\225JS\202:\320\220\263\304\304"
  "\200\16\0\306\224e\354\352\366O\64\220\207\21%\244\303d\230\12\24\321p\32\3Cb\10\13j!("
  ",\205\240\260\24\202\302R\10\12K!(,\205\260\240\26\2Cb\14(\2U\230\14\323AR@\215"
  "'\302\374\0\366\300\34$\204\202\210\22J\2R \12H\201( \5\242\200\24\210\2R \212D\25"
  "\374\200\177\0C@\11\0\306\260F,k\366\77<LH!\35&\303T\240\10\324\260\240\26\202\302R"
  "\10\12K!(,\205\240\260\24\202\302R\10\13j!\64 \6\201V\230\16R\42Z>\220\346\7\202"
  "T\301\17\370\7\60\4\324\244\20\225\377\42\0\306\314\203kk\366\37\15\310$A\24\227#!h\214\204"
  "\260)\22\1\247H\4\35\342DL\24\5!a\22\204\204I\20\223%A\234\210D\320!\22\1\247H"
  "\10\233\42!h\214\304\200\71\22\5%I\210\311\202\16\201\32RB\232\200\32\22\201gH\14\232\42\241"
  "$\236\204\222x\22J\202\240(\211\241\242$\206J\242\20,\310B\260\30\14\242B\70\210\312\340@$"
  "\203#J\14\15)\61\60\246\304\240\250\22\205\341J\0\307t\227j{\366g\6\223!i\64\10#\262"
  "$\210\211\222\30*IB\270 \211 s$\202\314Q\31\26\307\344P\30\223CaH\222\204!I\22"
  "\206$I\30\222$aH\222\204!I\22\206$I\30\222$aH\222\204!I\22\206$I\30\222$"
  "aH\222\204!I\22\206$I\30\222$aH\222\204!I\22\206$I\30\222$aH\222\204!I"
  "\22\306\344P\30\223CaT\206\305\221\10\62G\42\310\34\11\341\202$\206J\222 &J\242\210,\211"
  "\243\321$\26\3\224\10\23\307\210\246\254\373\365O\22\220Ay\60\210c\242$\212J\222 .Hb\310"
  "\34\211!s$\4\306\300\60\22\202\342P\30\11!\221$\214\204\220H\22FBH$\11#!$\222"
  "\204\221\20\22I\302H\10\211$a$\4\305\241\60\22\302\242X\30\211!s$\206\314\221 .H\242"
  "\250$\11c\242$\220\7\223P\24O\342\7\230\205\246\60!\24\204\224H\22Q\42ID\211$\21%"
  "\222\4\324(\30\316cp\60\20\341\241\214\20\322a\32R\202C\200\4\30\302\61X\212\6Q\61\30\6"
  "\42P\34\213\3!\34\24D\202\250\6\24\0\307\220\245p[\366\37\15\213\5A\34\34\42at\10E"
  "\341\31\24\205gP\24\236AQt\10\205\301!\24\310\345P<\11G\361$\34\305\223p\24O\302Q"
  "<\11G\361$\34\305\223p\30M\302q,\11\347\241$\234\207\222p\36\212\242y(\214\345\221<\22"
  "\207\2A\32K\344P\64\23C\321L\14EC)\24L\245P,\213@Q(\26\305\240 \24\312b"
  "P\20\212dQ$\10\305\321(\22\204\302h\30\11BQ\64\16\305\240(\30IbP\24\13%\61("
  "\12\305\222\30\24E\202I\14\12\303\320(\6\205\251\254\0\0\310\0\221l[\366'\15\206%A\10\34"
  "\303d\234\212\263\302d$\2\216\221\30.IBI@\11%\1%\224\4\224P\22PBI@\11%"
  "qH\224\204\61Q\22\306DI\30\23%aL\224\204\61Q\22\207DY\30\221\304\301$\222\307\222H"
  " J\2\221$\11d\202$\20\312\221\70*G\302X\4\212#a(\6\205\221(\26\203\302H\20\213"
  "\42a$\204F\221\60\22A\303H\30\26$QT\222DAQ\22\305dI\24\22&Q$\2\203\223"
  "(\22c\62\310\4\213lk\366\37\15E\346@\14\33#\21p\214D\320)\22A\247H\4\34#!"
  "l\214\304\220\71\22KBq,\211\344\261$\20\210\242@ J\243\200(\217\1\222H\204G\62\21\34"
  "\10\345H\30\27#\61h\214\204\360\20\24F\42x\20\212\42\21\70\214D\221\10\32G\242H\4\14$"
  "Q$\204\204\222(\22CaK\214\211\203\200%\214\203\225(\22U\202PT\11BQ%\10E\225 "
  "\24\242\222x*RC\32\201V\234\220\320\0\0\310\25\206lk\366\37\15E\346@\14\33#\21p\214"
  "D\320)\22A\247H\10\33#!l\214\4q)\30K\42y,\211\344\241(\20\210\302\60 \312c"
  "\200$\22\341\201P\4\307Q\71\22\5\306H\10\33#\21<\206E\221\10\36\204\242H\4\16#Q$"
  "\2\6\222(\22\202\42I\24\211\301\240%\362\13\4ZD\11\351\60\25(\2E((\305\240\260\24\202"
  "\302R\10\12K\61((\5\201V\230\14\323AR@\317\346\0\0\310\70\205l[\366'\15\206%A"
  "\10\34\303d\234\212\263\302d$\2\216\221\30.IBI@\11%\241<\224\4\22Q\22\207DI\34"
  "\22%qH\224\304!Q\22\207DI \21%\241<\224\4\224P\22PBY\70\211\304a<\222\307"
  "\20I \201\4!w\224\214E\240\61\24C\246X\14\12#A,\212\204\221\20\32E\302H\4\15#"
  "aX\20\204QI\22\5EI\24\223%QH\230D\221\10\14N\242H\214\311\0\310\200Tlk\366"
  "'H\6jH\15*A\65\240\12S\225\10!\332E!\31\247\2\65\250\206\211\322\20 \3\1Y\14"
  "\14\2\201(\244\304\230\20\25\222*\370\1\177\300'P\375\0\217t\230\12\24\201\66\244\206\5\265\20\24"
  "\226BPX\12AmHG\240\14S\0\0\310\213\134lk\366'H\6jH\15*A\65\240\12\23"
  "\245\0'\325\346\70\25(\42\65P\216\207\20i\30\202\203\60 \13\242\220 \20\205\224\20\25\321\17\370"
  "\7\60~@@\60\21\243bB\15\252\340\7\374\0C\240\42\26\320\302HP\11#A%\14\205\244\60"
  "\314\16R\42Z@\16\7\1\0\311\300\216l[\366'\15\5\6A\10\34\343T\234W$\2\216\221\30"
  "\60HBQ<\11E\361$\24\305\223P\24OBQ<\11E\361$\24\305\223P\24OBQ<\11"
  "E\361$\224\4\224P\26NBi\60\211\344\261$\22\210\222H\42I\42\221 \11\204r$\20\312\221"
  "\70,F\302X\10\12#a(\6\205\221(\26D\302H\20\213BQ$\204\206\221(\22A\343H\24"
  "\26$QT\222DAQ\22\305dI\24\22&Q$\2\203\223(\22c\62\311\304\211lk\366\37\15"
  "\205\306@\14\234\42\21t\212D\320)\22A\247H\4\235\42!p\212\304\220\71\22K\342I,\211'"
  "\261$\236\304\222x\22\212cI(\220$\241D\220D\62\71\22H\305H\30\230\42\61l\212\204\360\30"
  "\24E\42x\24I\201\303P\20\211\240\201$\210D\300H\22DBH,\11\42\61\24\266\304\230\70\10"
  "X\302\70X\211\42Q%\10E\225 \24U\202PT\11B!*\211\247\42\65\244\21h\305\11\11\15"
  "\0\311\334\317qK\366/\15\212\306@\34\236!a\200\4E\1\22\24\5HP\24 AQ\200\4\205"
  "\341\31\24J\202H\34\12%A$\16\205\222 \22\207BI\20\211C\241$\10\4\242P\22\4\2Q"
  "(\210\2\201(\24D\201@\26\11\242@ \215\3Q \20\207\201(\20\210\303@\24\10\304a \12"
  "\4\342\60\20E\342p\30\212Aa\70\214\205\260(\30\7CX\24\212\244\21\60\10E\262\31\24\311f"
  "P$\233A\201t\4\5\322\21\24G\42\240\10\212#!L\4\205\221\30\24\2\42P\24\212A! "
  "\2E\221 \24\2\42P\20\212A\61 \2\5\221 \24\3\42P\20\210\42A \2Ea\60\20\5"
  "\42P\30\204\343` \2\205T\200\24\247\22\1\0\316\134\214lk\366_\16\221\241I<\10&\361$"
  "\226\304\223\30\62GB\330\30\211\240S$\202N\221\10:E\42\350\24\11\201S$\206\314\221X\22O"
  "bI<\211%\361$\226\306\222P I\42\231\34\11\244b$\16\213\221\30\66EBx\4\214\42\21"
  "@\6E\221\10\36\205\202H\4\15$A$\2F\222 \22BbI\20\11B\320%\306\4\42\310\22"
  "\306\301J\24\10+A(\252\4\241\250\22\204BT\22OEjH#\320\212\23\22\32\0\323\14\267p"
  "[\366\37\15J\306@ \234!qt\6\205\321\31\24FgP\30\235Aat\6\305\261!\24\246\22"
  "S\70\14\210b\71\24\210C\241$\10\304\241P\22\203\302P(\211Aa(\224\304\240\60\30HbP"
  "\30\16#\61(\214G\221\30\24\306\243H\14\12\343Q$\6\205\361(\22\203\302x\24\211Aa\70\214"
  "\304\240\60\32GbP\30\12%\61(\14\205\222\30\24\206BI\14\12C\241$\6\205\241P\22\203\302"
  "P(\211Aa(\224\304\240\60\24JbP\30\12%\61(\14\305\301\31\24\206GP\24\37AQ\200"
  "\2E\1\12\24\305GP\30\36A\201h\10\205\251T\0\0\325X\300p[\366g\14\221AB<\10"
  "H\321$ E\243x\24\215\302\340\20\212\302\63(\12\317\240(<\203\242\360\14\212\302\63(\14\16\241"
  "@\24\204\302P \11#a(\220\304\201\60\24\10\2I\24\12\4\201$\12\206\201@\22\205\203@ "
  "\211\342\61 \220D\361\30\20H\242x\14\10$Q<\6\4\222(\36\3\2I\24\16\2\201$\212F"
  "\201@\22\205\2A \211B\201 \220D\241@\20H\242P \10$Q(\20\4\222(\24\10\2I"
  "\24\12\4\201$\12\5\222\60\24\205\2I\30\11C\201(\10\205\241@\60\206\42\261\34\212\304r(\24"
  "\12\242X$\211\202\201(\12\207\301(\42\303\243\60\25\5\0\325`~\260[\366o\12)\2\62H\11"
  "\7\1)\234\204\301!\24\205gP\24\236AQ|\4E\341\31\32Cgp\14\13\202A<\206\204\221"
  "\60\36\3\2I\24\217\1\201$\212\307\200@\22\305c@ \211\302A$\14E\321(\24\204\302P "
  "\30C\221\134\14\205R\71\24\313\4Q\60\20E\341\60\30\305\17XI\313)\71SL\246\22CRL"
  "\311\71dQ.\314S\202BP\311I\61\65\242\2\0\325t\355m[\366O\14\214\241((\10\345@"
  "\34\22\204\202\30\20H\42A\10\11$\221 \204D`\31\20BH@\10!\1!\210\2\204\20\22\20"
  "BH@\10\211\300\62 \204\244\1A \204\204\200 \220\204\204\200 \220\204\204\200 \22\3BH\10"
  "\10\42\61 \204\204\200 \22\303D@\20\211a\42 \210\304\60\21\20Db\230\10\10\42\61L\4\4"
  "\221\30&\2\202H\14\23\1A$\206\211\200 \22\3BH\10\10\42\61 \204\204\200 \22\3BH"
  "\10\10\42\61 \204\204\200 \22\3BH\10\10\42\61 \204\204\200 \22\3BH\10\10\42\61 \204"
  "\204\200 \22\3BH\10\10\2IH\32\20\4BH\10\212 A \204\304\60!\20Bb\220\24\10"
  "!\61H\12\204\220  \6BH\24\216\3!$\14\6\202\20\22\311AA\10\11\15!$\0\326\25"
  "\216\255[\366g\10\347a\62\64\210\10\261$\242\204\220I\22\301\6I\4\34\301\21p\202G\260\11 "
  "\202&\200\14\227\1\62$\212\4\361\30\22F\202p\14\210#\221$\6\304\221H\22\3\342H$\211\1"
  "q$\10\307\200\70\22\303cH\30\11\1\62(\10\205\0\31.\3\204\260\20\17\242b\70\212\11\223\60"
  "\42M\2i<\211\345 %tL\4ZH\210\351\70\25h\205\202Z\14\12K\61(,\5\241\240\26"
  "\4\252@\63L\10I\21\71\234\3\0\0";



int state = 0;
void setup() {
  Serial.begin(9600);
  Serial.println("ILI9341 Test!");
  
      SPI.begin();
      rfid.PCD_Init();
  
 
  tft.begin();

  // read diagnostics (optional but can help debug problems)
  uint8_t x = tft.readcommand8(ILI9341_RDMODE);
  Serial.print("Display Power Mode: 0x"); Serial.println(x, HEX);
  x = tft.readcommand8(ILI9341_RDMADCTL);
  Serial.print("MADCTL Mode: 0x"); Serial.println(x, HEX);
  x = tft.readcommand8(ILI9341_RDPIXFMT);
  Serial.print("Pixel Format: 0x"); Serial.println(x, HEX);
  x = tft.readcommand8(ILI9341_RDIMGFMT);
  Serial.print("Image Format: 0x"); Serial.println(x, HEX);
  x = tft.readcommand8(ILI9341_RDSELFDIAG);
  

  radio.begin();
  radio.openReadingPipe(0, address);
  radio.setPALevel(RF24_PA_MIN); //전원공급에 관한 파워레벨을 설정합니다. 모듈 사이가 가까우면 최소로 설정합니다.

//거리가 가까운 순으로 RF24_PA_MIN / RF24_PA_LOW / RF24_PA_HIGH / RF24_PA_MAX 등으로 설정할 수 있습니다.

//높은 레벨(거리가 먼 경우)은 작동하는 동안 안정적인 전압을 가지도록 GND와 3.3V에 바이패스 커패시터 사용을 권장함
  radio.startListening(); //모듈을 수신기로 설정
  
  pinMode(4, OUTPUT);
  digitalWrite(4, LOW);
  pinMode(5, OUTPUT);
  digitalWrite(5, LOW);
  
 
  digitalWrite(6, HIGH);
  digitalWrite(7, HIGH);
  state = 0;
}




int detachtime = 0;

void loop(void) {
  if (state == 0) {    
    if (radio.available()) {
      char text[32] = "";
      radio.read(&text, sizeof(text));
      Serial.println(text);
      
    
      tft.fillScreen(ILI9341_WHITE); // 배경색으로 화면을 지웁니다
  
      char *token = strtok(text, " ");
      int tokenIndex = 0;
  
      while (token != NULL) {
        tokenIndex++;
        if (tokenIndex == 1) {
          Serial.print("Second word: ");
          Serial.println(token);
          
          yield();
          
          u8g2_for_adafruit_gfx.begin(tft);
          u8g2_for_adafruit_gfx.setFont(JalnanTTF); // 한글 폰트 설정
          u8g2_for_adafruit_gfx.setFontMode(1);    // Transparent
          u8g2_for_adafruit_gfx.setForegroundColor(ILI9341_BLACK);  // 글자 색상 설정
          u8g2_for_adafruit_gfx.setBackgroundColor(ILI9341_WHITE);  // 배경 색상 설정
          u8g2_for_adafruit_gfx.setFontDirection(1); // 기본 방향 (가로)
          
          int textWidth = u8g2_for_adafruit_gfx.getUTF8Width(token);
          
          
          u8g2_for_adafruit_gfx.setCursor(100, 160-(textWidth/2));
          u8g2_for_adafruit_gfx.print(token);
          break;
        }
        token = strtok(NULL, " ");
      }
      pinMode(4, INPUT);
      digitalWrite(4, HIGH);
      pinMode(5, INPUT);
      digitalWrite(5, HIGH);
      SPI.begin();
      rfid.PCD_Init();
      Serial.println(F("Ready to scan RFID tags."));
              
      state = 1;
 
      
    } 
  }
  else if (state == 1) {
    rfid.PCD_Init();
    if (!rfid.PICC_IsNewCardPresent())
    {
      
      detachtime++;
      if (detachtime > 10)
      {
        Serial.print("때짐");
        detachtime=0;
      }
      return; 
    }
    
    
    if (!rfid.PICC_ReadCardSerial()){
      return;
    }
    
    detachtime = 0;
    Serial.print(F("PICC type: "));
    MFRC522::PICC_Type piccType = rfid.PICC_GetType(rfid.uid.sak);
    Serial.println(rfid.PICC_GetTypeName(piccType));
    
    Serial.println(F("The NUID tag is:"));
    Serial.print(F("In hex: "));
    for (byte i = 0; i < rfid.uid.size; i++) {
      Serial.print(rfid.uid.uidByte[i] < 0x10 ? " 0" : " ");
      Serial.print(rfid.uid.uidByte[i], HEX);
    }
    Serial.println();
    
    Serial.print(F("In dec: "));
    for (byte i = 0; i < rfid.uid.size; i++) {
      Serial.print(' ');
      Serial.print(rfid.uid.uidByte[i], DEC);
    }
    Serial.println();
    
    rfid.PICC_HaltA();
    rfid.PCD_StopCrypto1();
  }

}

/**
 * Helper routine to dump a byte array as hex values to Serial.
 */
void printHex(byte *buffer, byte bufferSize) {
  for (byte i = 0; i < bufferSize; i++) {
    Serial.print(buffer[i] < 0x10 ? " 0" : " ");
    Serial.print(buffer[i], HEX);
  }
}

/**
 * Helper routine to dump a byte array as dec values to Serial.
 */
void printDec(byte *buffer, byte bufferSize) {
  for (byte i = 0; i < bufferSize; i++) {
    Serial.print(' ');
    Serial.print(buffer[i], DEC);
  }
}
